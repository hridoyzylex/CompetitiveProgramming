<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml">
<head>

<title>Sphere Online Judge (SPOJ)  - Problem CHMAZE</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" id="metatag">
<META NAME="Keywords" CONTENT="programming, language, algorithm, spoj, contest, contester, Java, C#, Pascal, C, C++, python, ruby, caml, ocaml, perl, haskell, lisp, prolog, fortran, assembler, asembler, functional, online, judge, problem, problemset, ACM">

<link href="/gfx/favicon.png" rel="shortcut icon" type="image/x-icon">
<link href="/rss/" rel="alternate" type="application/rss+xml" title="RSS Feed">
<link href="/themes/common.css" rel="stylesheet" type="text/css" id="theme">
<link href="/style.css" rel="stylesheet" type="text/css" id="theme">
<link href="/themes/tooltips.css" rel="stylesheet" type="text/css" id="theme">
<script type='text/javascript' src='/gfx/jquery.js'></script>
<script type="text/javascript" src="/gfx/jquery.timers.js"></script>
<style type="text/css">
<!--
.maintable {width: 755px;} 
-->
</style>
<script type="text/javascript" language="javascript">
<!--
function UnCryptMailto(s) {
	var n=0;
	var r="";
	for(var i=0;i<s.length;i++) {		
		n=s.charCodeAt(i); 
		if (n>=8364) {n = 128;}
		r += String.fromCharCode(n+(2));	
	}
	return r;
}
function linkTo_UnCryptMailto(s)	{
	location.href=UnCryptMailto(s);
}
// -->
</script>

<script type="text/javascript">
function recordOutboundLink(link, category, action) {
  try {
    var pageTracker=_gat._getTracker("UA-XXXXX-X");
    pageTracker._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100)
  }catch(err){}
}
</script>

    <script type="text/javascript" src="/gfx/SyntaxHighlighter/scripts/shCore.js"></script>
	<script type="text/javascript" src="/gfx/SyntaxHighlighter/scripts/shBrushCpp.js"></script>
	<script type="text/javascript" src="/gfx/SyntaxHighlighter/scripts/shBrushCSharp.js"></script>
    <script type="text/javascript" src="/gfx/SyntaxHighlighter/scripts/shBrushJava.js"></script>
    <script type="text/javascript" src="/gfx/SyntaxHighlighter/scripts/shBrushPhp.js"></script>
    <script type="text/javascript" src="/gfx/SyntaxHighlighter/scripts/shBrushPython.js"></script>
	<link type="text/css" rel="stylesheet" href="/gfx/SyntaxHighlighter/styles/shCore.css"/>
	<link type="text/css" rel="stylesheet" href="/gfx/SyntaxHighlighter/styles/shThemeDefault.css"/>
	
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>
	

		<meta property="og:site_name" content="Spoj.pl"/>
    <meta property="og:image" content="http://www.spoj.pl/gfx/spoj-fb.jpg"/>

</head>
<body>
<center>
<table cellpadding="10" cellspacing="0" class="maintable" id="maintable">
<tr>
    <td colspan="2" class="header">
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
		<td class="headerleft"/>
		<td class="headercenter">
<h1><IMG alt="Sphere Online Judge" title="Sphere Online Judge" src="/gfx/sphere-spoj-small.png" border=0 style="margin-top:-4px;margin-bottom:-4px"></h1>

		<div style="position: relative; width: 807px;">
		<div style="position: absolute; left: -192px; top: 8px;"><script type="text/javascript"><!--
google_ad_client = "ca-pub-4453360425583535";
/* Spoj - wiezowiec */
google_ad_slot = "2703472077";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
		</div>
		</td>
		<td class="headerright"/>
	</tr>
	</table>
    </td>
</tr>
<tr><td class="menu" width="92" valign="top">


<div class="menucmd"><a href="/logout"><b style="font-weight:normal">Log Out</b></a><br><b style="font-weight:normal; margin-right:-100px">muntasir</b><br><hr><a href="/uploads">upload&nbsp;files</a><br><a href="/contests/add">add&nbsp;contest</a><br><a href="/groups/add">add&nbsp;group</a><br><a href="/groups">group list</a><br><a href="/problems/my">problem&nbsp;list</a><br><hr><a href="/myaccount">my account</a><br><a href="/tutorials">tutorials</a><br><br><a href="/status">status</a><br><a href="/submit">submit</a><br><a href="/problems/classical/">problems</a><br><a href="/search">search</a><br><br><a href="/">news</a><br><a href="/contests">contests</a><br><a href="/ranks/">ranks</a><br><br><a href="/forum">forum</a><br><a href="/comments">comments</a><br><a href="/tools">tools</a><br><a href="/credits">credits</a><br><hr></div><a href="/problems/classical/"></a><br>

	<div class="time">
Server time:</div>
<div class="time">
2011-10-19
<br>
<b>22 : 22 : 02</b>
</div>

</td><td style="width: 748px; padding:0px;" valign="top" class="content0">
        <table width="100%" cellpadding="0" cellspacing="0">
        <tr>
                <td style="padding:0px;" colspan="2"><center>
                                
                </center></td>
        </tr>
        <tr>
                <td class="content" width="99%" style="padding: 10px"><script type='text/javascript' src='/gfx/jquery.bgiframe.js'></script>
<script type='text/javascript' src='/gfx/jquery.tooltip.js'></script>
<script type='text/javascript' src='/gfx/jquery.cxhelp.js'></script>



 <!-- wykorzystywane w pcontent.html (by wiele) -->

<table class="problems" width="100%">
<tr class="navigation">
<td><a href="/submit/CHMAZE/">Submit</a></td>
<td><a href="/status/CHMAZE,muntasir/">My submissions</a></td>
<td><a href="/status/CHMAZE/">All submissions</a></td>
<td><a href="/ranks/CHMAZE/">Best solutions</a></td>
<td><a href="/problems/CHMAZE.ps">PS</a></td>
<td><a href="/problems/CHMAZE.pdf">PDF</a></td>
<td><a href="/problems/classical/">Back to list</a></td>
</tr>
</table>

<div class="prob">

<!-- google_ad_section_start -->
<!-- plik z pomoca kontekstowa (cxhelp_*) dziedziczony po pindex.html -->

<div style="position: absolute;">
<div class="fb-like" data-href="http://www.spoj.pl/problems/CHMAZE/" data-send="true" data-layout="box_count" data-width="70" data-show-faces="false"></div>
</div>

<script type="text/javascript" src="/gfx/jscripts/tiny_mce/plugins/asciimath/js/ASCIIMathMLwFallback.js"></script>
<!--script type="text/javascript" src="/gfx/jscripts/tiny_mce/plugins/asciisvg/js/ASCIIsvgPI.js"></script-->
<script type="text/javascript">
<!--
var AScgiloc = 'http://www.imathas.com/imathas/filter/graph/svgimg.php';
var AMTcgiloc = "/files/gif/";
-->
</script>

<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>3387. Changing Maze</h1>
		<h2>Problem code: CHMAZE</h2>
	</td>
	</tr>
</table>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-4453360425583535";
/* Spoj - baner gÃ³rny */
google_ad_slot = "5796055248";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<p align="justify">
<p>Luke Skywalker and his sister/love interest Leia are trying to get through a killer maze. And I
mean killer! Every time step, the boundaries change. If our twins/lovebirds ever visit a square the
same time a boundary appears, they&#8217;re toast. There is no need to panic; the Force will guide them
through the maze, and they will not die. However, the Force needs to know what advice to give
and is therefore asking you for help.<br><br>
Luke and Leia begin in the northwest corner of a maze. They want to make it to the southeast
corner of the maze. At any given time step, Luke and Leia can move one square north, south, east,
or west, or they can stay where they are. At every time step, the boundaries of the maze change:
there is a finite list of patterns; if Luke and Leia are still in the maze when the list of patterns
is exhausted, the maze cycles through again from the beginning of the list. You need to compute
whether Luke and Leia can make it to the southeast corner of the maze, and, if so, the minimum
number of time steps necessary for them to get there. Remember, the Force is counting on you! If
you give the Force bad advice, we&#8217;ll have to wait around for A Newer Hope and Force Knows how
long that could take!


<h3>Input</h3>
<p>The input consists of several test cases. Each case (but the last) will begin with a line containing
three decimal integers. The first is the number of rows in the maze; the second is the number of
columns in the maze; the third is the number of patterns in the list. The first two numbers will
be inclusively between 1 and 20; the third will be inclusively between 1 and 10. The integers will
be separated by exactly one space and will be followed by one <EOL>. Immediately following this
line will be a number of patterns, equal to the number specified on the first line. Each pattern will
consist of r lineas each containing c characters, where r is the number of rows and c is the number
of columns indicated on the first line. Each character will be either 0 (indicating no boundary) or
1 (indicating a boundary). Each line will be terminated by <EOL>, and an extra <EOL> will follow
each pattern. The northwest corner of the first pattern will always be zero, since Luke and Leia
will be starting from there. The last case will be three zeros, separated by exactly one space and
followed by exactly one <EOL>. This case is not to be processed; it indicates the end of input.


<h3>Output</h3>
<p>The output cases are to appear in the same order in wich they appear in the input. Each output
case should be of the form <i>Case c: Luke and Leia can escape in s steps.</i> or of the form
<i>Case c: Luke and Leia cannot escape.</i> c and s are decimal integers. c in the number of the
case being processed (starting with 1) and s is the minimum number of time steps Luke and Leia
require to reach the southeast corner. Each line should be terminated by exactly one <EOL>.


<h3>Example</h3>

<pre>
<b>Input:</b>
5 5 1
00000
00000
00000
00000
00000
5 5 2
00000
00000
00000
00000
00000
01110
01110
11111
01110
01110
0 0 0

<b>Output:</b>
Case 1: Luke and Leia can escape in 8 steps.
Case 2: Luke and Leia cannot escape.

</pre>


<script type="text/javascript"><!--
google_ad_client = "ca-pub-4453360425583535";
/* Spoj - wiersz */
google_ad_slot = "3432347421";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/users/dilaang">Daniel Gómez Didier</a></td></tr>
<tr><td>Date:</td><td>2008-11-18</td></tr>
<tr><td>Time limit:</td><td>3s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Languages:</td><td>All except: ERL JS PERL 6 </td></tr>
<tr><td>Resource:</td><td>2007 U.Nacional - Circuito de Maratones ACIS / REDIS</td></tr>	
</table><!-- google_ad_section_end -->

<div id="ccontent">
<!-- google_ad_section_start -->

<hr style="clear:both;"/>
<a href="#" onclick="toggleComments(); return false;"><span id="comments_sh">hide</span> comments</a><br/>

<a id="comments"></a>
<table id="comments_table" width="100%">
		<tr>
		<td colspan="2">
				</td>
	</tr>
	<tr>
		<td colspan="2">
		<script type="text/javascript"><!--
google_ad_client = "ca-pub-4453360425583535";
/* Spoj - wiersz */
google_ad_slot = "3432347421";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
		</td>
	</tr>
	
	<script language="JavaScript">
	<!--
	$(document).ready(function(){
        $('.pager_link').bind('click', function(me){
                var href=$(me.currentTarget).attr('href');
		$('#ccontent').animate({opacity: 0.5},1);
                $.ajax({
                        type: "GET",
                        url: href+",ajax=1",
                        contentType: "application/x-www-form-urlencoded;charset=ISO-8859-2",
                        success: function(data){
                                $('#ccontent').html(data);
				$('#ccontent').animate({opacity: 1.0},1);
                        },
                        error: function(err){
                                alert('error');
                        }
                });
                return false;
        });
	});
	-->
	</script>
	

			
	<tr>
		<td colspan="2" class="comm comm_odd ">
		<font >
		2011-05-31 17:35:53 <b><a href="/users/krunalmodi">Krunal</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/19306/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/19306/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/19306/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				I agree with :D<br/>Why \n is written as &lt;EOL&gt; ? Browsers are not able to show it. Do not just blindly go by sample test cases. Each pattern is followed by two \n
						</td>
	</tr>
				
	<tr>
		<td colspan="2" class="comm comm_even ">
		<font >
		2011-02-25 16:44:57 <b><a href="/users/ahmed_sherif">Ahmed Sherif Zein</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/16162/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/16162/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/16162/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				I'm getting WA , What is that EOL thing ?<br/>Also The description of the input doesn't match the input in the example at all..
						</td>
	</tr>
				
	<tr>
		<td colspan="2" class="comm comm_odd ">
		<font >
		2010-06-14 10:07:10 <b><a href="/users/zobayer">DotA Addict</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/9329/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/9329/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/9329/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				It's actually easy if you read with scanf, and forget timestep and consider the input just a 3D grid.
						</td>
	</tr>
				
	<tr>
		<td colspan="2" class="comm comm_even ">
		<font >
		2010-03-04 23:36:13 <b><a href="/users/zukow">:D</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/6701/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/6701/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/6701/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				EOL = End Of Line<br/>EOF = End Of File
						</td>
	</tr>
				
	<tr>
		<td colspan="2" class="comm comm_odd ">
		<font >
		2009-08-30 14:03:46 <b><a href="/users/time">Abdelrahman Hatem</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/3372/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/3372/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/3372/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				what does eol mean?
						</td>
	</tr>
				
	<tr>
		<td colspan="2" class="comm comm_even ">
		<font >
		2009-07-31 20:01:45 <b><a href="/users/majidesmaili">majid</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/2963/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/2963/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/2963/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				thx ":D"<br/>I got NZEC 3 times because of EOL :(<br/>If u code by java use scanner ...
						</td>
	</tr>
				
	<tr>
		<td colspan="2" class="comm comm_odd ">
		<font >
		2009-07-07 09:11:09 <b><a href="/users/zukow">:D</a></b> 
		</font>
					(<a href="/comment/CHMAZE/sh/2649/"><font color="red"><b>hide</b></font></a>)
							(<a href="/comment/CHMAZE/edit/2649/"><b>edit</b></a>) 
							(<a href="/comment/CHMAZE/del/2649/" onclick="javascript:return confirm('Are you sure you want to delete this comment ?')"><font color="red"><b>delete</b></font></a>)
				<br/>
				I really admire people who did this one at the first try. First of all You can access a field even if it's occupied at a given turn, only next turn status count. Second: the problem states there's an extra EOL and there seems to be in test data, so don't be fooled by the example :)
						</td>
	</tr>
			
</table>


<script language="javascript" type="text/javascript">
<!--
function getCookieVal (offset) {
        var endstr = document.cookie.indexOf (";", offset);
        if (endstr == -1) { 
                endstr = document.cookie.length; 
        }
        return unescape(document.cookie.substring(offset, endstr));
}

function GetCookie (name) {
  var arg = name + "=";
  var alen = arg.length;
  var clen = document.cookie.length;
  var i = 0;
  while (i < clen) {
    var j = i + alen;
    if (document.cookie.substring(i, j) == arg) {
      return getCookieVal (j);
      }
    i = document.cookie.indexOf(" ", i) + 1;
    if (i == 0) break; 
    }
  return null;
}

function toggleComments() {
        var a = document.getElementById('comments_table');
        var d = a.style.display;
        if( d == "" || d == "block" ){
                d = "none";
                document.getElementById('comments_sh').innerHTML = 'show';
        } else {
                d = "block";
                document.getElementById('comments_sh').innerHTML = 'hide';
        }
        a.style.display = d;
        document.cookie="comments_table="+d+"; path=/;";
}

if( GetCookie('comments_table') == 'none' ){
        document.getElementById('comments_sh').innerHTML = 'show';
        document.getElementById('comments_table').style.display = 'hide';
}

-->
</script>


<!-- google_ad_section_end -->
</div>
<table width="100%">
                <tr>
                <td colspan="2" height="20px"></td>
        </tr>
        <form method="post" action="/comment/CHMAZE/add/">
        <tr> <td style="padding-left:5px;" colspan="2">Leave a Comment</td> </tr>
        <tr>
                <td valign="top"></td>
                <td><textarea name="content" cols="40" rows="3"></textarea></td>
        </tr>
                <tr>
                <td colspan="2" style="padding-left: 5px;">
                        <input type="submit" value="Publish"/>
                        <input type="hidden" name="pcode" value="CHMAZE"/>
                </td>
        </tr>
<tr>
<td colspan="2" class="smallgrey" style="padding-left:5px;">
Notes:
<br>1. Don't post any source code here.
<br>2. Please be careful, leave short comments only. Don't spam here.
<br>3. For more discussion (hints, ideas, solutions) please visit our <a href="/forum">forum</a>.
<br>4. Authors of the problems are allowed to delete the post and use html code here (e.g. to provide some useful links).
</td>
</tr>
        </form>
        </table>

</div>
        </td>
<tr>
        <td style="padding:0px" colspan="2"><center>
                
</center></td>
</tr>
</table>
</td>
</tr>

<tr>
<td colspan="2" class="footer">
<div class="a-footer"></div>
<script language="javascript" type="text/javascript">
<!--
function swapSheet(sheet, caller) {
    document.getElementById('theme').href=sheet;
    document.cookie="css_0="+sheet+"; path=/;";
    caller.href="#bottom";
}

function setWidth(w, caller) {
    document.getElementById('maintable').style.width=w;
    document.cookie="res="+w+"; path=/;";
    caller.href="#bottom";
}



//-->

</script>
        <table width="100%">
    <tr>
	<td align="left" width=10% class="cfooter">
	<a href="/info/">About SPOJ</a>
	</td>
	<td align="center" class="cfooter">
	    width:
	    <a href="/?rsl=855px"  onClick="setWidth('855px', this)">900</a>
	    <a href="/?rsl=980px"  onClick="setWidth('980px', this)">1024</a>
	    <a href="/?rsl=100%" onClick="setWidth('100%', this)">Full</a>
	    &nbsp;&nbsp;
	    theme:
	    <a href="/?css=/themes/skin1.css" onClick="swapSheet('/themes/skin1.css', this)">olive</a>
	    <a href="/?css=/themes/skin2.css" onClick="swapSheet('/themes/skin2.css', this)">banana</a>
	    <a href="/?css=/themes/skin3.css" onClick="swapSheet('/themes/skin3.css', this)">plum</a>
	    	</td>
		<td align="center" class="cfooter">
		 <span title="The discussion channel of the Sphere Online Judge community.">
		 <a href="irc://irc.freenode.net/spoj"><b>#spoj</b> at freenode</a>
		 </span>
	</td>
		<td width=10% class="cfooter" style="text-align:right">
		<a href="/rss/" ><img src="/gfx/rss10x10.gif" border=0>&nbsp;RSS</a>&nbsp;
	</div>
	</td>
    </tr>
    </table>
    </tr></table>
</center>
<div class="a-header"></div>

<div id="fb-root"></div>
<script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>

<div style="font-size:10px; margin-top:4px; color: rgb(85,80,95);"><center>
<a href="http://www.spoj.pl" style="color:black">SPOJ</a>
System &copy; 2011
<a href="http://sphere-research.com" style="color:black">Sphere Research Labs | Projekty informatyczne i aplikacje na zamówienie</a>. 
All Rights Reserved.</center></div>

<script type="text/javascript">
  var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-10507872-1']);
      _gaq.push(['_trackPageview']);
        (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		      })();
		      </script>
		      
</body>
</html>